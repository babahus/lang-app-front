<section class="bg-[#C3DCE3] min-h-screen flex-col justify-center">
  <div class="pt-12 max-w-5xl mx-auto px-3 md:px-5">
    <div class="bg-white rounded-lg w-full flex p-2 md:p-3 lg:p-4 relative justify-between items-center">

      <div class="flex gap-2 items-center">
        <button type="button" (click)="isCardInfoVisible = !isCardInfoVisible" class=" bg-gray-100 hover:bg-gray-200 p-2 rounded-full">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 18v-5.25m0 0a6.01 6.01 0 001.5-.189m-1.5.189a6.01 6.01 0 01-1.5-.189m3.75 7.478a12.06 12.06 0 01-4.5 0m3.75 2.383a14.406 14.406 0 01-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 10-7.517 0c.85.493 1.509 1.333 1.509 2.316V18" />
          </svg>
        </button>
        <!-- Card info for Courses  -->
        <div (appClickOutside)="closeCardInfo()" [ngClass]="{'hidden' : !isCardInfoVisible}"  class="fixed inset-0 transition-opacity z-10"></div>
        <div class="modal absolute top-[10%] left-[10%] bg-white rounded-lg shadow-lg z-20 w-[94%] sm:w-3/4" *ngIf="isCardInfoVisible">
          <div class="p-4">
            <div class='text-sm' style="font-family: Montserrat">
              <div class="relative mb-4">
                <img src="assets/img/course_card.png" alt="Course Image" class="sm:w-full sm:h-full h-24 w-80">
                <div class="absolute lg:top-[29%] lg:left-[51%] md:top-[28%] md:left-[51%] top-[25%] left-[50%]">
                  <span class="lg:text-2xl md:text-lg text-sm p-0 font-bold md:p-0 lg:p-1">1.</span>
                </div>
                <div class="absolute top-[78%] left-[87%] sm:top-[84%] sm:left-[89%]">
                  <span class="lg:text-2xl md:text-lg text-sm font-bold p-0 md:p-0 lg:p-1">2.</span>
                </div>
                <div class="absolute top-[1%] left-[87%] sm:top-[3%] sm:left-[90%]">
                  <span class="lg:text-2xl md:text-lg text-sm p-0 font-bold md:p-0 lg:p-1">3.</span>
                </div>
              </div>

              <ul>
                <li><strong>1:</strong>{{'courseTitleDescription2' | translate}}</li>
                <li><strong>2:</strong>{{'attachButtonDescription' | translate}}</li>
                <li><strong>3:</strong>{{'infoButtonDescription' | translate}}</li>
              </ul>

              <div class='text-sm' style="font-family: Montserrat">
                ...
              </div>
            </div>
          </div>
        </div>
        <!-- Card info for Courses Ended  -->
      </div>
      <div (click)="openListExercise()" class="bg-gray-100 cursor-pointer rounded-lg text-[#757575] p-2">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93.398.164.855.142 1.205-.108l.737-.527a1.125 1.125 0 011.45.12l.773.774c.39.389.44 1.002.12 1.45l-.527.737c-.25.35-.272.806-.107 1.204.165.397.505.71.93.78l.893.15c.543.09.94.56.94 1.109v1.094c0 .55-.397 1.02-.94 1.11l-.893.149c-.425.07-.765.383-.93.78-.165.398-.143.854.107 1.204l.527.738c.32.447.269 1.06-.12 1.45l-.774.773a1.125 1.125 0 01-1.449.12l-.738-.527c-.35-.25-.806-.272-1.203-.107-.397.165-.71.505-.781.929l-.149.894c-.09.542-.56.94-1.11.94h-1.094c-.55 0-1.019-.398-1.11-.94l-.148-.894c-.071-.424-.384-.764-.781-.93-.398-.164-.854-.142-1.204.108l-.738.527c-.447.32-1.06.269-1.45-.12l-.773-.774a1.125 1.125 0 01-.12-1.45l.527-.737c.25-.35.273-.806.108-1.204-.165-.397-.505-.71-.93-.78l-.894-.15c-.542-.09-.94-.56-.94-1.109v-1.094c0-.55.398-1.02.94-1.11l.894-.149c.424-.07.765-.383.93-.78.165-.398.143-.854-.107-1.204l-.527-.738a1.125 1.125 0 01.12-1.45l.773-.773a1.125 1.125 0 011.45-.12l.737.527c.35.25.807.272 1.204.107.397-.165.71-.505.78-.929l.15-.894z" />
          <path stroke-linecap="round" stroke-linejoin="round" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
      </div>
<!--      Modal window-->

      <div [ngClass]="{'hidden': !openDetails}" (click)="closeFilterDetails()" class="fixed inset-0 transition-opacity z-10"></div>
      <div (appClickOutside)="closeFilterDetails()" [ngClass]="{'hidden' : !openDetails}" class="modal absolute top-[90%] right-[5%] z-20 border border-gray-100 bg-white shadow-lg rounded-lg p-3 text-sm" style="font-family: Montserrat">
        <div class="z-20">
          <ul class="font-semibold text-[#757575]">
            <li class="hover:bg-blue-50 p-2 rounded hover:text-[#2B788B]">
              <div class="flex items-center space-x-2 h-5 ">
                <input id="remember_free_courses" aria-describedby="remember" type="checkbox"
                       class="w-4 h-4 cursor-pointer border border-gray-300 rounded bg-gray-50 focus:ring-3 focus:ring-[#2B788B]"
                       required="" [(ngModel)]="showFreeCourses" (change)="filterCourses($event)">
                <label for="remember_free_courses" class="uppercase cursor-pointer">

                  {{'free_courses' | translate}}
                </label>
              </div>
            </li>
            <li class="hover:bg-blue-50 p-2 rounded hover:text-[#2B788B]">
              <div class="flex items-center space-x-2 h-5 ">
                <input id="remember_paid_courses" aria-describedby="remember" type="checkbox"
                       class="w-4 h-4 cursor-pointer border border-gray-300 rounded bg-gray-50 focus:ring-3 focus:ring-[#2B788B]"
                       required="" [(ngModel)]="showPaidCourses" (change)="filterCourses($event)" >
                <label for="remember_paid_courses" class="uppercase cursor-pointer">

                  {{'paid_courses' | translate}}
                </label>
              </div>
            </li>
            <li class="hover:bg-blue-50 p-2 rounded hover:text-[#2B788B]">
              <div class="flex items-center space-x-2 h-5">
                <input id="attached_paid_courses" aria-describedby="remember" type="checkbox"
                       class="w-4 h-4 cursor-pointer border border-gray-300 rounded bg-gray-50 focus:ring-3 focus:ring-[#2B788B]"
                       required="" [(ngModel)]="showMyAttachedCourses" (change)="filterCourses($event)" >
                <label for="attached_paid_courses" class="uppercase cursor-pointer">
                  <!--                Paid Courses-->
                  {{'my_courses' | translate}}
                </label>
              </div>
            </li>
          </ul>
        </div>
      </div>

    </div>
  </div>
  <div class="pt-6 mx-auto max-w-5xl px-5 lg:pt-12 pb-12 ">
    <div *ngIf="filteredCourses" class=" bg-white rounded-lg grid gap-3 mb-6 lg:mb-16 md:grid-cols-1 p-3 lg:grid-cols-2 justify-items-center items-center">

<!--///////////-->
      <ng-container *ngFor="let course of filteredCourses">
        <div class="items-start relative bg-[#C3DCE3] overflow-hidden rounded-lg shadow sm:flex">
          <div class="h-48 md:h-full md:rounded-l-lg w-full md:w-1/2 lg:w-1/2 relative">
            <img src="./assets/img/courses-page/eleven-talking-points-tw.jpeg" class="rounded-l-lg object-cover object-center w-full h-full" alt="">
          </div>
          <div class="px-2 pt-2 w-full lg:w-1/2">
            <div class="flex justify-start items-center" style="font-family: Montserrat">
                <div>
                  <h3 class="cursor-pointer normal-case font-bold tracking-tight text-[#2B788B]" style="font-family: DelaGothic">
                    <a *ngIf="isCourseAttached(course.id); else noLink"
                       [routerLink]="['/course', course.id]"
                       class="hover:underline">
                      <span class="truncate-text normal-case font-semibold text-base">{{ course.title }}</span>
                    </a>
                    <ng-template #noLink>
                      <span class="truncate-text normal-case font-semibold text-base">
                        {{ course.title }}
                      </span>
                    </ng-template>
                  </h3>
                </div>
            </div>
            <div style="font-family: Montserrat">
              <div>
                <p class="text-[#2B788B] uppercase text-sm lg:text-base font-bold">
                  ${{ course.price }}
                </p>
              </div>
              <p class="truncate-text mt-3 mb-4 font-medium text-xs lg:text-sm text-gray-700">{{ course.description }}</p>
            </div>

            <div *ngIf="!isCourseAttached(course.id)" class="absolute cursor-pointer -bottom-2 -right-2 bg-[#2B788B] rounded-xl p-2 text-white" (click)="attachCourseToUser(course.id)">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m6-6H6" />
              </svg>
            </div>
            <div *ngIf="isCourseAttached(course.id)" class="absolute cursor-pointer -bottom-2 -right-2 bg-[#945069] rounded-xl p-2 text-white" (click)="detachCourseFromUser(course.id)">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 12h12" />
              </svg>
            </div>
            <div class="absolute cursor-pointer -top-2 -right-2 bg-[#A15993] rounded-xl p-2 text-white" (click)="openCourseDetailModal(course)">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="w-6 h-6" viewBox="0 0 16 16">
                <path d="m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533L8.93 6.588zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"/>
              </svg>
            </div>
          </div>
        </div>
      </ng-container>
      <!-- Detail Course Modal -->
        <div (appClickOutside)="closeDetailCourseModal(selectedCourse)" *ngIf="showCourseDetailModal" class="fixed inset-0 flex items-center justify-center z-50">
          <div class="absolute inset-0 bg-gray-500 bg-opacity-75"></div>
          <div class="relative overflow-hidden z-30 w-full p-2 md:w-1/2 lg:w-2/5">
            <div class="modal bg-[#F6F5F4] rounded-lg shadow-lg p-3">
              <button type="button"
                      class="text-white absolute top-1 right-1 hover:scale-105  bg-[#945069] cursor-pointer tracking-widest focus:outline-none font-medium  rounded-full text-sm p-1 text-center"
                      (click)="this.showCourseDetailModal = false"
                      style="font-family: DelaGothic"
              >
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
              </button>
              <div class="lg:p-6">
                  <h1 class="text-xl text-[#2B788B] font-semibold mb-2 underline-header" style="font-family: DelaGothic;">{{'courseDetailsTitle' | translate}}</h1>
                  <div class="bg-[#C3DCE3] rounded-3xl p-3">
                    <p class="text-lg normal-case font-bold text-[#2B788B] md:text-xl mb-4" style="font-family: Montserrat;">{{ selectedCourse?.title }}</p>
                    <p class="text-xs normal-case md:text-sm font-semibold text-[#757575] mb-6" style="font-family: Montserrat;">{{ selectedCourse?.description }}</p>

                    <div class="space-y-2">
                      <div *ngFor="let stage of selectedCourse?.course_stages; let i = index">
                        <div (click)="toggleCheck(i)" class="relative cursor-pointer w-full bg-[#F6F5F4] items-center justify-start py-3 overflow-hidden font-medium transition-all rounded-3xl group" style="font-family: Montserrat">
                          <div [ngClass]="{'bg-[#2B788B] absolute bottom-0 transition-all ease-out duration-700 translate-x-0 left-0 w-full h-48': stage.isClicked}" class="-translate-x-full"></div>
                          <div class="flex items-center px-2">
                            <div [ngClass]="{'block': stage.isClicked, 'hidden': !stage.isClicked}">
                              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5 text-white duration-700 ease-in-out transform transition-all z-20" [ngClass]="{'translate-x-1': stage.isClicked}">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                              </svg>
                            </div>
                            <span class="relative z-50 px-3 font-bold" [ngClass]="{'transform translate-x-1 transition-colors duration-700 ease-in-out text-white': stage.isClicked, 'text-[#2B788B]': !stage.isClicked}">{{ stage.title }}</span>
                          </div>
                        </div>
                        <div *ngIf="stage.isClicked" class="bg-[#C3DCE3] rounded-lg p-2">
                          <div class="p-1">
                            <p class="text-base normal-case font-bold text-[#2B788B] md:text-lg mb-4" style="font-family: DelaGothic;">*{{ stage?.title }}</p>
                            <div class="pl-2">
                              <p class="text-xs md:text-sm  font-semibold text-[#757575] mb-6" style="font-family: Montserrat;">{{ stage?.description }}</p>
                              <p class="text-xs md:text-sm font-medium text-[#757575] mb-6" style="font-family: Montserrat;">
                                {{'stageContainsExercises1' | translate}} <strong>{{ stage?.stage_exercises?.length }}</strong> {{'stageContainsExercises2' | translate}}
                              </p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <ng-container *ngIf="!selectedCourse?.course_stages">
                      <p class="text-xs md:text-sm font-medium text-[#757575] mb-6" style="font-family: Montserrat;">{{'no_stages_this_course' | translate}}</p>
                    </ng-container>
                  </div>
                  <div class="w-full px-12 pt-4 flex justify-center" style="font-family: DelaGothic">
                    <button *ngIf="this.selectedCourse && !isCourseAttached(this.selectedCourse!.id)" (click)="attachCourseToUser(this.selectedCourse!.id)" type="button" class="inline-flex w-full justify-center rounded-full bg-[#2B788B] px-3 py-2 text-sm font-semibold text-white shadow-sm hover:opacity-90 sm:ml-3 sm:w-auto">{{'attachCourseButton' | translate}}</button>
                  </div>
              </div>
            </div>
          </div>

      </div>
      <!-- Detail Course Modal -->
      <!--      ///////-->
    </div>

    <div *ngIf="pagination" class="flex justify-center items-center h-10 space-x-2">
      <!-- Начальный элемент "страница назад" -->
      <button
        [disabled]="pagination!.current_page === 1"
        (click)="goToPage(pagination!.current_page - 1)"
        class="h-full flex justify-center items-center w-10 rounded-full text-[#2B788B] border-2 border-[#2B788B]"
      >
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
        </svg>
      </button>

      <!-- Цикл для отображения страниц -->
      <ng-container *ngFor="let page of pages">
        <ng-container *ngIf="page === 1 || page === pagination!.last_page || (page >= pagination!.current_page - 2 && page <= pagination!.current_page + 2)">
          <button
            [class.bg-[#2B788B]]="pagination!.current_page === page"
            [class.text-white]="pagination!.current_page === page"
            [class.text-[#2B788B]]="pagination!.current_page !== page"
            (click)="goToPage(page)"
            class="h-full w-10 rounded-full text-[#2B788B] font-bold border-2 border-[#2B788B]"
          >
            {{ page }}
          </button>
        </ng-container>

        <!-- Троеточие для пропущенных страниц -->
        <span *ngIf="page === 1 && pagination!.current_page > 4" class="w-10 h-full flex items-center justify-center rounded-full text-teal-500">
      ...
          </span>
        <span *ngIf="page === pagination!.last_page && pagination!.current_page < pagination!.last_page - 3" class="w-10 h-full flex items-center justify-center rounded-full text-teal-500">
      ...
          </span>
      </ng-container>

      <!-- Конечный элемент "страница вперед" -->
      <button
        [disabled]="pagination!.current_page === pagination!.last_page"
        (click)="goToPage(pagination!.current_page + 1)"
        class="h-full flex justify-center items-center w-10  rounded-full text-[#2B788B] border-2 border-[#2B788B]"
      >
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
        </svg>
      </button>
    </div>
  </div>
</section>
